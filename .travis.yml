language: csharp
mono: none
os: windows

solution: src/dotnet-structuring/dotnet-structuring.csproj

before_script:
    - export PATH="$PATH:$HOME/.dotnet/tools"

script:
    - choco install dotnetcore-sdk
    - choco install opencover.portable
    - choco install codecov
    - dotnet --version
    - dotnet restore
    - dotnet build src/dotnet-structuring/dotnet-structuring.csproj

install:
    - dotnet restore src/dotnet-structuring/dotnet-structuring.csproj
global:
    - DOTNET_SKIP_FIRST_TIME_EXPERIENCE=1
    - DOTNET_CLI_TELEMETRY_OPTOUT=1

cache:
  directories:
    - "$HOME/.nuget/packages"
    - "$HOME/.local/share/NuGet/Cache"
test_script:
    - OpenCover.Console.exe -register:user -target:"C:/Program Files/dotnet/dotnet.exe" -targetargs:test -output:".\coverage.xml" -oldstyle
    - codecov -f "coverage.xml"